import{b as F,l as $,R as b,j as e,P as h,B as i,C as T,d as r,g as t,ak as B,k as g,ah as I,al as L,I as A,E as N,s as O,t as V,m as c,M as d,D as w,F as U,H as _,A as y,J as G,L as S,am as z,n as C,K as H,O as Q,Q as X,U as W,V as o,X as J,w as K}from"./index-CUqXZ82V.js";import{g as q}from"./hooks-DbXgi7GY.js";import{P as Y,g as Z}from"./PeriodFilter-DpH4Af4z.js";const ae=()=>{const n=F(),j=$(n.breakpoints.down("md")),[a,u]=b.useState({page:1,limit:j?5:20,sortBy:"engagementScore",sortOrder:"DESC"});b.useEffect(()=>{const s=j?5:20;a.limit!==s&&u({...a,limit:s,page:1})},[j]);const[p,P]=b.useState(!1),{data:l,isLoading:R}=q(a),x=(s,m)=>{u({...a,[s]:m||void 0,page:1})},k=(s,m)=>{u({...a,page:m+1})},D=s=>{u({...a,limit:parseInt(s.target.value,10),page:1})},E=()=>{u({page:1,limit:20,sortBy:"engagementScore",sortOrder:"DESC"})},f=s=>s>=90?"success":s>=75?"info":s>=60?"warning":"default",v=s=>{const m=s.split(" ");return m.length>=2?`${m[0][0]}${m[1][0]}`.toUpperCase():s.substring(0,2).toUpperCase()};return R?e.jsx(h,{elevation:3,sx:{p:3,borderRadius:3},children:e.jsx(i,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(T,{})})}):l?e.jsxs(i,{sx:{width:"100%",maxWidth:"100%",overflowX:"hidden"},children:[e.jsxs(t,{container:!0,spacing:{xs:1.5,sm:2},sx:{mb:3,width:"100%",maxWidth:"100%",margin:0},children:[e.jsx(t,{item:!0,xs:6,sm:6,md:2.4,sx:{width:"100%",maxWidth:"100%"},children:e.jsxs(h,{elevation:0,sx:{p:{xs:1.5,sm:2},borderRadius:2,border:`2px solid ${n.palette.divider}`,width:"100%",maxWidth:"100%",overflow:"hidden"},children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:"Total Filtrado"}),e.jsx(r,{variant:"h5",fontWeight:"bold",color:"primary",sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},wordBreak:"break-word"},children:l.summary.filteredChildren}),e.jsxs(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},wordBreak:"break-word"},children:["de ",l.summary.totalChildren]})]})}),e.jsx(t,{item:!0,xs:6,sm:6,md:2.4,sx:{width:"100%",maxWidth:"100%"},children:e.jsxs(h,{elevation:0,sx:{p:{xs:1.5,sm:2},borderRadius:2,border:`2px solid ${n.palette.divider}`,width:"100%",maxWidth:"100%",overflow:"hidden"},children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:"Idade MÃ©dia"}),e.jsxs(r,{variant:"h5",fontWeight:"bold",color:"info.main",sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},wordBreak:"break-word"},children:[l.summary.avgAge.toFixed(1)," anos"]})]})}),e.jsx(t,{item:!0,xs:6,sm:6,md:2.4,sx:{width:"100%",maxWidth:"100%"},children:e.jsxs(h,{elevation:0,sx:{p:{xs:1.5,sm:2},borderRadius:2,border:`2px solid ${n.palette.divider}`,width:"100%",maxWidth:"100%",overflow:"hidden"},children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:"Engajamento MÃ©dio"}),e.jsxs(r,{variant:"h5",fontWeight:"bold",color:"success.main",sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},wordBreak:"break-word"},children:[l.summary.avgEngagementScore.toFixed(1),"%"]})]})}),e.jsx(t,{item:!0,xs:6,sm:6,md:2.4,sx:{width:"100%",maxWidth:"100%"},children:e.jsxs(h,{elevation:0,sx:{p:{xs:1.5,sm:2},borderRadius:2,border:`2px solid ${n.palette.divider}`,width:"100%",maxWidth:"100%",overflow:"hidden"},children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:"PresenÃ§a MÃ©dia"}),e.jsxs(r,{variant:"h5",fontWeight:"bold",color:"secondary.main",sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},wordBreak:"break-word"},children:[l.summary.avgPresenceRate.toFixed(1),"%"]})]})}),e.jsx(t,{item:!0,xs:6,sm:6,md:2.4,sx:{width:"100%",maxWidth:"100%"},children:e.jsxs(h,{elevation:0,sx:{p:{xs:1.5,sm:2},borderRadius:2,border:`2px solid ${n.palette.divider}`,width:"100%",maxWidth:"100%",overflow:"hidden"},children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:"Com DecisÃ£o"}),e.jsx(r,{variant:"h5",fontWeight:"bold",color:"warning.main",sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},wordBreak:"break-word"},children:l.summary.childrenWithDecisions})]})})]}),e.jsxs(h,{elevation:0,sx:{p:2,borderRadius:2,mb:2,border:`1px solid ${n.palette.divider}`},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:p?2:0},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(B,{}),e.jsx(r,{variant:"subtitle1",fontWeight:"bold",children:"Filtros"}),l.filters.summary&&e.jsx(g,{label:l.filters.summary,size:"small",variant:"outlined"})]}),e.jsxs(i,{children:[e.jsx(I,{size:"small",startIcon:e.jsx(L,{}),onClick:E,children:"Limpar"}),e.jsx(A,{size:"small",onClick:()=>P(!p),children:p?e.jsx(N,{}):e.jsx(O,{})})]})]}),e.jsx(V,{in:p,children:e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(Y,{period:a.period,startDate:a.startDate,endDate:a.endDate,onPeriodChange:s=>{const m=Z(s);u({...a,period:s,startDate:m?.startDate,endDate:m?.endDate,page:1})},onStartDateChange:s=>x("startDate",s),onEndDateChange:s=>x("endDate",s)})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(c,{fullWidth:!0,label:"Buscar por nome",placeholder:"Digite o nome da crianÃ§a...",value:a.search||"",onChange:s=>x("search",s.target.value),size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(c,{fullWidth:!0,select:!0,label:"GÃªnero",value:a.gender||"",onChange:s=>x("gender",s.target.value),size:"small",children:[e.jsx(d,{value:"",children:"Todos"}),e.jsx(d,{value:"M",children:"Masculino"}),e.jsx(d,{value:"F",children:"Feminino"})]})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(c,{fullWidth:!0,type:"number",label:"Idade MÃ­nima",value:a.minAge||"",onChange:s=>x("minAge",s.target.value?Number(s.target.value):void 0),size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:2,children:e.jsx(c,{fullWidth:!0,type:"number",label:"Idade MÃ¡xima",value:a.maxAge||"",onChange:s=>x("maxAge",s.target.value?Number(s.target.value):void 0),size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(c,{fullWidth:!0,select:!0,label:"Categoria",value:a.isNewcomer?"newcomer":a.isVeteran?"veteran":a.hasLowEngagement?"low_engagement":"",onChange:s=>{u({...a,isNewcomer:s.target.value==="newcomer"?!0:void 0,isVeteran:s.target.value==="veteran"?!0:void 0,hasLowEngagement:s.target.value==="low_engagement"?!0:void 0,page:1})},size:"small",children:[e.jsx(d,{value:"",children:"Todos"}),e.jsx(d,{value:"newcomer",children:"ğŸ†• Newcomers (Ãºltimos 3 meses)"}),e.jsx(d,{value:"veteran",children:"ğŸ† Veteranos (1+ ano)"}),e.jsx(d,{value:"low_engagement",children:"âš ï¸ Baixo Engajamento (<50%)"})]})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(c,{fullWidth:!0,type:"number",label:"Engajamento MÃ­nimo",value:a.minEngagementScore||"",onChange:s=>x("minEngagementScore",s.target.value?Number(s.target.value):void 0),size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(c,{fullWidth:!0,type:"number",label:"Engajamento MÃ¡ximo",value:a.maxEngagementScore||"",onChange:s=>x("maxEngagementScore",s.target.value?Number(s.target.value):void 0),size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(c,{fullWidth:!0,type:"number",label:"PresenÃ§a MÃ­nima (%)",value:a.minPresenceRate||"",onChange:s=>x("minPresenceRate",s.target.value?Number(s.target.value):void 0),size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(c,{fullWidth:!0,type:"number",label:"PresenÃ§a MÃ¡xima (%)",value:a.maxPresenceRate||"",onChange:s=>x("maxPresenceRate",s.target.value?Number(s.target.value):void 0),size:"small"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(c,{fullWidth:!0,select:!0,label:"Ordenar por",value:a.sortBy||"engagementScore",onChange:s=>x("sortBy",s.target.value),size:"small",children:[e.jsx(d,{value:"name",children:"Nome"}),e.jsx(d,{value:"age",children:"Idade"}),e.jsx(d,{value:"engagementScore",children:"Engajamento"}),e.jsx(d,{value:"totalPagelas",children:"Total Pagelas"}),e.jsx(d,{value:"presenceRate",children:"Taxa PresenÃ§a"})]})}),e.jsx(t,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(c,{fullWidth:!0,select:!0,label:"Ordem",value:a.sortOrder||"DESC",onChange:s=>x("sortOrder",s.target.value),size:"small",children:[e.jsx(d,{value:"ASC",children:"Crescente"}),e.jsx(d,{value:"DESC",children:"Decrescente"})]})})]})})]}),j?e.jsx(w,{spacing:1.5,sx:{width:"100%",maxWidth:"100%"},children:l.children.length===0?e.jsx(h,{elevation:3,sx:{p:3,borderRadius:2,textAlign:"center"},children:e.jsx(r,{color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:"Nenhuma crianÃ§a encontrada com os filtros selecionados"})}):l.children.map(s=>e.jsx(U,{elevation:1,sx:{borderRadius:1.5,width:"100%",maxWidth:"100%",overflow:"hidden",borderLeft:`4px solid ${s.gender==="F"?n.palette.secondary.main:n.palette.info.main}`,position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:`linear-gradient(90deg, ${s.gender==="F"?n.palette.secondary.main:n.palette.info.main} 0%, ${s.gender==="F"?n.palette.secondary.light:n.palette.info.light} 100%)`}},children:e.jsx(_,{sx:{p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}},width:"100%",maxWidth:"100%"},children:e.jsxs(w,{spacing:1,children:[e.jsx(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,flex:1},children:[e.jsxs(r,{fontWeight:"bold",color:"primary",sx:{fontSize:{xs:"0.75rem",sm:"1rem"}},children:["#",s.rank]}),e.jsx(y,{sx:{width:{xs:28,sm:36},height:{xs:28,sm:36},bgcolor:s.gender==="F"?n.palette.secondary.main:n.palette.info.main,fontSize:{xs:11,sm:14}},children:v(s.name)}),e.jsxs(i,{sx:{flex:1,minWidth:0},children:[e.jsx(r,{fontWeight:"medium",sx:{fontSize:{xs:"0.8rem",sm:"1rem"},wordBreak:"break-word"},children:s.name}),e.jsxs(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},wordBreak:"break-word"},children:[s.gender==="M"?"Masculino":"Feminino"," â€¢ ",s.age," anos"]})]})]})}),e.jsx(G,{sx:{my:.5}}),e.jsxs(t,{container:!0,spacing:1,children:[e.jsx(t,{item:!0,xs:6,children:e.jsxs(i,{children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:"Clubinho"}),e.jsx(r,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"1rem"},wordBreak:"break-word"},children:s.club?`#${s.club.number}`:"-"})]})}),e.jsx(t,{item:!0,xs:6,children:e.jsxs(i,{children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:"Cidade"}),e.jsx(r,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"1rem"},wordBreak:"break-word"},children:s.address?`${s.address.city}, ${s.address.state}`:"-"})]})}),e.jsx(t,{item:!0,xs:6,children:e.jsxs(i,{children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:"Tempo"}),e.jsx(g,{label:`${s.monthsParticipating}m`,size:"small",variant:"outlined",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},height:{xs:20,sm:24}}})]})}),e.jsx(t,{item:!0,xs:6,children:e.jsxs(i,{children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:"Pagelas"}),e.jsx(r,{variant:"body2",fontWeight:"bold",sx:{fontSize:{xs:"0.8rem",sm:"1rem"}},children:s.stats.totalPagelas})]})})]}),e.jsxs(i,{children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:"PresenÃ§a"}),e.jsxs(r,{variant:"body2",fontWeight:"bold",sx:{fontSize:{xs:"0.8rem",sm:"1rem"}},children:[s.stats.presenceRate.toFixed(1),"%"]})]}),e.jsx(S,{variant:"determinate",value:s.stats.presenceRate,sx:{height:{xs:4,sm:6},borderRadius:2,bgcolor:`${n.palette.success.main}15`,"& .MuiLinearProgress-bar":{bgcolor:n.palette.success.main,borderRadius:2}}})]}),e.jsxs(i,{sx:{display:"flex",gap:.75,flexWrap:"wrap",alignItems:"center"},children:[e.jsx(g,{icon:e.jsx(z,{sx:{fontSize:{xs:12,sm:16}}}),label:`${s.stats.engagementScore.toFixed(0)}`,size:"small",color:f(s.stats.engagementScore),sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},height:{xs:20,sm:24},"& .MuiChip-label":{px:{xs:.5,sm:1}}}}),s.isActive&&e.jsx(g,{label:"Ativo",size:"small",color:"success",variant:"outlined",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},height:{xs:20,sm:24}}}),s.decisions.hasDecision&&e.jsx(g,{icon:e.jsx(C,{sx:{fontSize:{xs:12,sm:16}}}),label:s.decisions.decisionType,size:"small",color:"success",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"},height:{xs:20,sm:24}}})]})]})})},s.childId))}):e.jsxs(H,{component:h,elevation:3,sx:{borderRadius:2},children:[e.jsxs(Q,{children:[e.jsx(X,{children:e.jsxs(W,{sx:{bgcolor:"primary.main"},children:[e.jsx(o,{sx:{color:"white",fontWeight:"bold"},children:"Ranking"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},children:"CrianÃ§a"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},children:"Idade"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},children:"Clubinho"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},children:"Cidade"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},align:"center",children:"Tempo"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},align:"right",children:"Pagelas"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},align:"right",children:"PresenÃ§a"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},align:"center",children:"Engajamento"}),e.jsx(o,{sx:{color:"white",fontWeight:"bold"},align:"center",children:"Status"})]})}),e.jsx(J,{children:l.children.map(s=>e.jsxs(W,{hover:!0,children:[e.jsx(o,{children:e.jsxs(r,{fontWeight:"bold",color:"primary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:["#",s.rank]})}),e.jsx(o,{children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(y,{sx:{width:36,height:36,bgcolor:s.gender==="F"?n.palette.secondary.main:n.palette.info.main,fontSize:14},children:v(s.name)}),e.jsxs(i,{children:[e.jsx(r,{fontWeight:"medium",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:s.name}),e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem"}},children:s.gender==="M"?"Masculino":"Feminino"})]})]})}),e.jsxs(o,{sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:[s.age," anos"]}),e.jsx(o,{sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:s.club?`#${s.club.number}`:"-"}),e.jsx(o,{sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:s.address?`${s.address.city}, ${s.address.state}`:"-"}),e.jsx(o,{align:"center",children:e.jsx(g,{label:`${s.monthsParticipating}m`,size:"small",variant:"outlined"})}),e.jsx(o,{align:"right",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:s.stats.totalPagelas}),e.jsx(o,{align:"right",children:e.jsxs(i,{children:[e.jsxs(r,{variant:"body2",fontWeight:"bold",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:[s.stats.presenceRate.toFixed(1),"%"]}),e.jsx(S,{variant:"determinate",value:s.stats.presenceRate,sx:{mt:.5,height:4,borderRadius:2,bgcolor:`${n.palette.success.main}15`,"& .MuiLinearProgress-bar":{bgcolor:n.palette.success.main}}})]})}),e.jsx(o,{align:"center",children:e.jsx(g,{icon:e.jsx(z,{}),label:s.stats.engagementScore.toFixed(0),size:"small",color:f(s.stats.engagementScore)})}),e.jsx(o,{align:"center",children:e.jsxs(i,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[s.isActive&&e.jsx(g,{label:"Ativo",size:"small",color:"success",variant:"outlined"}),s.decisions.hasDecision&&e.jsx(g,{icon:e.jsx(C,{}),label:s.decisions.decisionType,size:"small",color:"success"})]})})]},s.childId))})]}),l.children.length===0&&e.jsx(i,{sx:{textAlign:"center",py:4},children:e.jsx(r,{color:"text.secondary",sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:"Nenhuma crianÃ§a encontrada com os filtros selecionados"})})]}),l.pagination&&e.jsx(i,{sx:{px:{xs:1,sm:0},mt:2},children:e.jsx(K,{component:"div",count:l.pagination.total,page:l.pagination.page-1,onPageChange:k,rowsPerPage:l.pagination.limit,onRowsPerPageChange:D,rowsPerPageOptions:j?[5,10,20]:[10,20,50,100],labelRowsPerPage:"Itens por pÃ¡gina:",labelDisplayedRows:({from:s,to:m,count:M})=>`${s}-${m} de ${M}`,sx:{"& .MuiTablePagination-toolbar":{flexWrap:"wrap",gap:1,px:{xs:0,sm:2}},"& .MuiTablePagination-selectLabel, & .MuiTablePagination-displayedRows":{fontSize:{xs:"0.75rem",sm:"0.875rem"}}}})})]}):e.jsx(h,{elevation:3,sx:{p:3,borderRadius:3},children:e.jsx(r,{color:"error",children:"Erro ao carregar crianÃ§as"})})};export{ae as C};
