import{c as g,j as e,b as v,P as h,B as a,C as y,d as i,k as x,g as l,aj as f,L as R,f as C}from"./index-CUqXZ82V.js";import{a as T}from"./hooks-DbXgi7GY.js";import{T as W}from"./TrendingDown-C_c6g0Ah.js";const F=g(e.jsx("path",{d:"M9 1h6v2H9zm10.03 6.39 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M13 14h-2V8h2z"}),"Timer"),M=({filters:m})=>{const n=v(),{data:c,isLoading:p}=T(m);if(p)return e.jsx(h,{elevation:3,sx:{p:3,borderRadius:3},children:e.jsx(a,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(y,{})})});if(!c||!c.byParticipationTime||c.byParticipationTime.length===0)return e.jsx(h,{elevation:3,sx:{p:3,borderRadius:3},children:e.jsx(i,{color:"text.secondary",children:"Sem dados de retenÃ§Ã£o para o perÃ­odo selecionado"})});const t=c.byParticipationTime,u=Math.max(...t.map(r=>r.total)),j={"0-3 meses":{label:"Novatos",icon:"ðŸŒ±",color:n.palette.info.main},"3-6 meses":{label:"Iniciantes",icon:"ðŸŒ¿",color:n.palette.success.main},"6-12 meses":{label:"Regulares",icon:"ðŸŒ³",color:n.palette.primary.main},"1+ ano":{label:"Veteranos",icon:"ðŸ†",color:n.palette.warning.main}},b=r=>{if(r===0)return null;const s=t[r-1];return t[r].presenceRate>s.presenceRate?e.jsx(C,{sx:{color:n.palette.success.main,fontSize:18}}):e.jsx(W,{sx:{color:n.palette.error.main,fontSize:18}})};return e.jsxs(h,{elevation:0,sx:{p:3,borderRadius:3,background:`linear-gradient(135deg, ${n.palette.background.paper} 0%, ${n.palette.primary.main}03 100%)`,border:`2px solid ${n.palette.divider}`},children:[e.jsxs(a,{sx:{mb:3},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:[e.jsx(F,{sx:{fontSize:28,color:n.palette.primary.main}}),e.jsx(i,{variant:"h5",fontWeight:"bold",children:"â±ï¸ Funil de RetenÃ§Ã£o"})]}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"AnÃ¡lise de engajamento por tempo de participaÃ§Ã£o"})]}),e.jsx(a,{sx:{mb:3},children:t.map((r,s)=>{const o=j[r.timeRange]||{label:r.timeRange,icon:"ðŸ“Š",color:n.palette.grey[500]},d=r.total/u*100;return e.jsxs(a,{sx:{mb:2},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:[e.jsx(i,{variant:"h6",sx:{minWidth:30},children:o.icon}),e.jsx(i,{variant:"subtitle1",fontWeight:"bold",children:o.label}),e.jsx(x,{label:r.timeRange,size:"small",variant:"outlined",sx:{borderColor:o.color,color:o.color}}),b(s)]}),e.jsx(a,{sx:{position:"relative",width:`${d}%`,maxWidth:"100%",minWidth:"30%",height:80,background:`linear-gradient(90deg, ${o.color} 0%, ${o.color}CC 100%)`,borderRadius:2,display:"flex",alignItems:"center",px:2,transition:"all 0.3s ease","&:hover":{transform:"translateX(4px)",boxShadow:`0 4px 12px ${o.color}40`}},children:e.jsxs(l,{container:!0,spacing:1,sx:{color:"white"},children:[e.jsx(l,{item:!0,xs:6,children:e.jsxs(a,{children:[e.jsx(i,{variant:"caption",sx:{opacity:.9},children:"Total"}),e.jsx(i,{variant:"h5",fontWeight:"bold",children:r.total}),e.jsxs(i,{variant:"caption",sx:{opacity:.8},children:["(",r.uniqueChildren," crianÃ§as Ãºnicas)"]})]})}),e.jsx(l,{item:!0,xs:6,children:e.jsxs(a,{children:[e.jsx(i,{variant:"caption",sx:{opacity:.9},children:"Taxa de PresenÃ§a"}),e.jsxs(i,{variant:"h5",fontWeight:"bold",children:[r.presenceRate.toFixed(1),"%"]}),e.jsxs(i,{variant:"caption",sx:{opacity:.8},children:["MÃ©dia: ",r.avgMonthsParticipating.toFixed(1)," meses"]})]})})]})}),e.jsxs(a,{sx:{mt:1,display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(x,{icon:e.jsx(f,{}),label:`${r.uniqueChildren} crianÃ§as`,size:"small",variant:"outlined"}),e.jsx(x,{label:`${r.meditationRate.toFixed(1)}% meditaÃ§Ã£o`,size:"small",color:"info",variant:"outlined"}),e.jsx(x,{label:`${r.verseRecitationRate.toFixed(1)}% recitaÃ§Ã£o`,size:"small",color:"secondary",variant:"outlined"})]})]},r.timeRange)})}),e.jsxs(a,{sx:{mt:3,p:2,bgcolor:"rgba(25, 118, 210, 0.08)",borderRadius:2},children:[e.jsx(i,{variant:"subtitle2",fontWeight:"bold",gutterBottom:!0,children:"ðŸ“ˆ AnÃ¡lise de ConversÃ£o"}),e.jsx(l,{container:!0,spacing:2,children:t.map((r,s)=>{if(s===0)return null;const o=t[s-1],d=(r.uniqueChildren/o.uniqueChildren*100).toFixed(1);return e.jsx(l,{item:!0,xs:12,sm:4,children:e.jsxs(a,{children:[e.jsxs(i,{variant:"caption",color:"text.secondary",children:[o.timeRange," â†’ ",r.timeRange]}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(i,{variant:"h6",fontWeight:"bold",color:"primary",children:[d,"%"]}),e.jsx(i,{variant:"caption",color:"text.secondary",children:"conversÃ£o"})]}),e.jsx(R,{variant:"determinate",value:parseFloat(d),sx:{mt:.5,height:4,borderRadius:2,bgcolor:`${n.palette.primary.main}15`,"& .MuiLinearProgress-bar":{bgcolor:n.palette.primary.main}}})]})},r.timeRange)})})]}),e.jsx(a,{sx:{mt:3,p:2,bgcolor:"rgba(76, 175, 80, 0.08)",borderRadius:2},children:e.jsxs(l,{container:!0,spacing:2,children:[e.jsxs(l,{item:!0,xs:12,sm:3,children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Total Geral"}),e.jsx(i,{variant:"h6",fontWeight:"bold",color:"success.main",children:t.reduce((r,s)=>r+s.total,0)})]}),e.jsxs(l,{item:!0,xs:12,sm:3,children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Taxa MÃ©dia"}),e.jsxs(i,{variant:"h6",fontWeight:"bold",color:"success.main",children:[(t.reduce((r,s)=>r+s.presenceRate,0)/t.length).toFixed(1),"%"]})]}),e.jsxs(l,{item:!0,xs:12,sm:3,children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Maior RetenÃ§Ã£o"}),e.jsxs(i,{variant:"h6",fontWeight:"bold",color:"success.main",children:[Math.max(...t.map(r=>r.presenceRate)).toFixed(1),"%"]})]}),e.jsxs(l,{item:!0,xs:12,sm:3,children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Taxa de Veteranos"}),e.jsxs(i,{variant:"h6",fontWeight:"bold",color:"success.main",children:[((t.find(r=>r.timeRange==="1+ ano")?.uniqueChildren||0)/t.reduce((r,s)=>r+s.uniqueChildren,0)*100).toFixed(1),"%"]})]})]})})]})};export{M as R};
